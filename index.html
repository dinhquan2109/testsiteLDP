<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Placement Test</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Nunito', 'Segoe UI', sans-serif;
            background: linear-gradient(135deg, #1e7e5f 0%, #0d5943 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        header {
            background: rgba(255, 255, 255, 0.1);
            padding: 15px 30px;
            border-radius: 10px;
            margin-bottom: 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            color: white;
            font-size: 24px;
            font-weight: bold;
            letter-spacing: 2px;
        }

        .support-btn {
            background: #ffd700;
            color: #0d5943;
            padding: 10px 25px;
            border-radius: 25px;
            font-weight: bold;
            border: none;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .hero-banner {
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1200 300"><rect fill="%231e7e5f" width="1200" height="300"/></svg>');
            background-size: cover;
            text-align: center;
            padding: 40px 20px;
            border-radius: 15px;
            margin-bottom: 30px;
            position: relative;
            overflow: hidden;
        }

        .hero-title {
            font-size: 48px;
            font-weight: 900;
            color: white;
            text-transform: uppercase;
            margin-bottom: 10px;
            text-shadow: 3px 3px 6px rgba(0,0,0,0.3);
        }

        .hero-title .easy {
            font-style: italic;
            color: #ffd700;
        }

        .hero-title .placement {
            color: #ff9800;
        }

        .hero-subtitle {
            background: white;
            color: #0d5943;
            font-size: 32px;
            font-weight: 900;
            padding: 10px 40px;
            display: inline-block;
            border-radius: 50px;
            margin-top: 10px;
        }

        .main-content {
            background: #fef8e6;
            border-radius: 20px;
            padding: 50px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.3);
            position: relative;
        }

        .decorative-lights {
            position: absolute;
            top: -20px;
            left: 0;
            right: 0;
            height: 40px;
            background: repeating-linear-gradient(90deg, 
                #ff6b6b 0px, #ff6b6b 20px, transparent 20px, transparent 25px,
                #4ecdc4 25px, #4ecdc4 45px, transparent 45px, transparent 50px,
                #ffe66d 50px, #ffe66d 70px, transparent 70px, transparent 75px,
                #a8e6cf 75px, #a8e6cf 95px, transparent 95px, transparent 100px
            );
            border-radius: 20px 20px 0 0;
        }

        .info-section {
            background: white;
            padding: 30px;
            border-radius: 15px;
            margin-bottom: 40px;
            border-left: 5px solid #1e7e5f;
        }

        .info-icon {
            font-size: 48px;
            float: left;
            margin-right: 20px;
            color: #1e7e5f;
        }

        .info-text {
            color: #333;
            line-height: 1.8;
            font-size: 16px;
        }

        .info-text strong {
            color: #1e7e5f;
        }

        .info-list {
            list-style: none;
            margin-top: 20px;
        }

        .info-list li {
            padding: 10px 0;
            padding-left: 30px;
            position: relative;
        }

        .info-list li:before {
            content: "✓";
            position: absolute;
            left: 0;
            color: #4caf50;
            font-weight: bold;
            font-size: 18px;
        }

        .form-section {
            background: white;
            padding: 40px;
            border-radius: 15px;
            margin-top: 30px;
        }

        .form-title {
            text-align: center;
            color: #0d5943;
            font-size: 24px;
            font-weight: bold;
            margin-bottom: 30px;
            text-transform: uppercase;
        }

        .form-row {
            display: block;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            color: #666;
            margin-bottom: 8px;
            font-size: 14px;
        }

        .form-group input {
            width: 100%;
            padding: 15px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            font-size: 16px;
            transition: all 0.3s;
        }

        .form-group input:focus {
            outline: none;
            border-color: #1e7e5f;
            box-shadow: 0 0 0 3px rgba(30, 126, 95, 0.1);
        }

        .form-group input.error {
            border-color: #f44336;
        }

        .error-message {
            color: #f44336;
            font-size: 12px;
            margin-top: 5px;
            display: none;
        }

        .error-message.show {
            display: block;
        }

        .submit-btn {
            width: 100%;
            padding: 18px;
            background: linear-gradient(135deg, #7cb342 0%, #558b2f 100%);
            color: white;
            border: none;
            border-radius: 50px;
            font-size: 18px;
            font-weight: bold;
            cursor: pointer;
            text-transform: uppercase;
            letter-spacing: 1px;
            transition: all 0.3s;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }

        .submit-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(0,0,0,0.3);
        }

        .illustration {
            position: absolute;
            right: 50px;
            bottom: 50px;
            width: 250px;
            opacity: 0.9;
        }

        .success-message {
            display: none;
            background: #4caf50;
            color: white;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            font-size: 18px;
            margin-top: 20px;
        }

        .success-message.show {
            display: block;
            animation: slideIn 0.5s;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(-20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Tablet (iPad) - 768px to 1024px */
        @media (max-width: 1024px) and (min-width: 769px) {
            .container {
                max-width: 90%;
            }

            .main-content {
                padding: 40px 30px;
            }

            .hero-title {
                font-size: 42px;
            }

            .hero-subtitle {
                font-size: 28px;
            }

            .form-section {
                padding: 35px 25px;
            }

            .illustration {
                width: 200px;
                right: 30px;
                bottom: 30px;
            }

            .info-section {
                padding: 25px;
            }
        }

        /* Mobile - max 768px */
        @media (max-width: 768px) {
            body {
                padding: 15px;
            }

            header {
                padding: 12px 20px;
                flex-direction: column;
                gap: 15px;
                text-align: center;
            }

            .logo {
                font-size: 20px;
            }

            .support-btn {
                padding: 8px 20px;
                font-size: 14px;
            }

            .hero-banner {
                padding: 30px 15px;
            }

            .hero-title {
                font-size: 32px;
            }

            .hero-subtitle {
                font-size: 24px;
                padding: 8px 25px;
            }

            .main-content {
                padding: 30px 20px;
            }

            .info-section {
                padding: 20px;
            }

            .info-icon {
                float: none;
                display: block;
                margin-bottom: 15px;
                margin-right: 0;
                text-align: center;
            }

            .info-text {
                font-size: 15px;
            }

            .form-section {
                padding: 25px 20px;
            }

            .form-title {
                font-size: 20px;
            }

            .form-row {
                display: block;
            }

            .form-group {
                margin-bottom: 15px;
            }

            .form-group label {
                font-size: 13px;
            }

            .form-group input {
                padding: 12px;
                font-size: 15px;
            }

            .submit-btn {
                padding: 15px;
                font-size: 16px;
            }

            .illustration {
                display: none;
            }

            .decorative-lights {
                height: 30px;
                background-size: 50px;
            }
        }

        /* Small Mobile - max 480px */
        @media (max-width: 480px) {
            .hero-title {
                font-size: 28px;
            }

            .hero-subtitle {
                font-size: 20px;
                padding: 6px 20px;
            }

            .main-content {
                padding: 25px 15px;
            }

            .form-title {
                font-size: 18px;
            }

            .info-text {
                font-size: 14px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <div class="logo">Aloha</div>
            <button class="support-btn">
                💬 Hỗ trợ khẩn cấp
            </button>
        </header>

        <div class="hero-banner">
            <h1 class="hero-title">
                <span class="easy">test</span><br>
                <span class="placement">PLACEMENT</span>
            </h1>
            <div class="hero-subtitle">TEST</div>
        </div>

        <div class="main-content">
            <div class="decorative-lights"></div>

            <div class="info-section">
                <div class="info-icon">📝</div>
                <div class="info-text">
                    <p><strong>Test</strong> được phát triển độc quyền bởi <strong>Aloha</strong> và được giảng dạy trên nền tảng trực tuyến, giúp phát triển khả năng giao tiếp Tiếng Anh đồng thời bổ trợ kỹ năng Speaking cho các chứng chỉ Tiếng Anh quốc tế. Chương trình đặc biệt phù hợp với học viên có nhu cầu tăng phản xạ giao tiếp trong các bối cảnh đời sống, công việc và học thuật.</p>
                    
                    <ul class="info-list">
                        <li><strong>Placement Test</strong> là bài kiểm tra xác định trình độ đầu vào của học viên, từ đó xây dựng lộ trình học phù hợp và hiệu quả với từng cá nhân.</li>
                        <li>Bài kiểm tra sẽ diễn ra trong vòng <strong>20 phút</strong>, để việc xác định trình độ đầu vào được chính xác hơn, vui lòng điền đầy đủ thông tin dưới đây và đọc kỹ hướng dẫn trước khi bắt đầu làm bài.</li>
                    </ul>
                </div>
            </div>

            <div class="form-section">
                <h2 class="form-title">Nhập thông tin để bắt đầu bài kiểm tra</h2>
                
                <form id="placementForm">
                    <div class="form-row">
                        <div class="form-group">
                            <label>* Họ và tên: (Ví dụ: Nguyễn Văn An)</label>
                            <input type="text" name="fullname" id="fullname" required placeholder="Nhập họ và tên đầy đủ">
                            <div class="error-message" id="fullnameError">Vui lòng nhập họ và tên đầy đủ</div>
                        </div>
                        <div class="form-group">
                            <label>Tuổi (không bắt buộc)</label>
                            <input type="number" name="age" id="age" placeholder="Nhập tuổi của bạn" min="1" max="120">
                            <div class="error-message" id="ageError">Tuổi phải từ 1 đến 120</div>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label>* Số điện thoại</label>
                            <input type="tel" name="phone" id="phone" required placeholder="Nhập số điện thoại">
                            <div class="error-message" id="phoneError">Số điện thoại phải có 10-11 chữ số</div>
                        </div>
                        <div class="form-group">
                            <label>* Email</label>
                            <input type="email" name="email" id="email" required placeholder="Nhập email của bạn">
                            <div class="error-message" id="emailError">Email không đúng định dạng (ví dụ: example@email.com)</div>
                        </div>
                    </div>

                    <button type="submit" class="submit-btn">ĐI TỚI BÀI THI</button>
                </form>

                <div class="success-message" id="successMessage">
                    ✓ Đã ghi nhận thông tin! Chuyển đến bài test...
                </div>
            </div>

            <div class="illustration">
                <svg viewBox="0 0 200 250" xmlns="http://www.w3.org/2000/svg">
                    <ellipse cx="100" cy="200" rx="60" ry="20" fill="#7cb342" opacity="0.3"/>
                    <path d="M 60 180 Q 60 150 80 140 L 80 200 Z" fill="#7cb342"/>
                    <path d="M 140 180 Q 140 150 120 140 L 120 200 Z" fill="#7cb342"/>
                    <circle cx="100" cy="100" r="40" fill="#fdd5b1"/>
                    <path d="M 70 85 Q 80 75 90 85" stroke="#333" stroke-width="3" fill="none"/>
                    <path d="M 110 85 Q 120 75 130 85" stroke="#333" stroke-width="3" fill="none"/>
                    <circle cx="85" cy="100" r="3" fill="#333"/>
                    <circle cx="115" cy="100" r="3" fill="#333"/>
                    <path d="M 85 115 Q 100 125 115 115" stroke="#333" stroke-width="2" fill="none"/>
                    <path d="M 60 70 Q 100 50 140 70" fill="#2c2c2c"/>
                    <rect x="70" y="140" width="60" height="60" rx="10" fill="#7cb342"/>
                    <circle cx="40" cy="120" r="15" fill="#ff9800"/>
                    <circle cx="160" cy="120" r="15" fill="#ff9800"/>
                </svg>
            </div>
        </div>
    </div>

    <script>
        function validatePhone(phone) {
            const phoneRegex = /^[0-9]{10,11}$/;
            return phoneRegex.test(phone);
        }

        function validateEmail(email) {
            const emailRegex = /^[a-z0-9._%+-]+@[a-z0-9.-]+\.[a-z]{2,}$/i;
            return emailRegex.test(email);
        }

        document.getElementById('fullname').addEventListener('blur', function() {
            const input = this;
            const error = document.getElementById('fullnameError');
            
            if (input.value.trim().length < 3) {
                input.classList.add('error');
                error.classList.add('show');
            } else {
                input.classList.remove('error');
                error.classList.remove('show');
            }
        });

        document.getElementById('age').addEventListener('blur', function() {
            const input = this;
            const error = document.getElementById('ageError');
            const value = input.value.trim();
            
            // Si le champ est vide, c'est OK (optionnel)
            if (value === '') {
                input.classList.remove('error');
                error.classList.remove('show');
                return;
            }
            
            const age = parseInt(value);
            if (isNaN(age) || age < 1 || age > 120) {
                input.classList.add('error');
                error.classList.add('show');
            } else {
                input.classList.remove('error');
                error.classList.remove('show');
            }
        });

        document.getElementById('phone').addEventListener('input', function() {
            const input = this;
            const error = document.getElementById('phoneError');
            
            if (input.value.length > 0 && !validatePhone(input.value)) {
                input.classList.add('error');
                error.classList.add('show');
            } else {
                input.classList.remove('error');
                error.classList.remove('show');
            }
        });

        document.getElementById('email').addEventListener('input', function() {
            const input = this;
            const error = document.getElementById('emailError');
            
            if (input.value.length > 0 && !validateEmail(input.value)) {
                input.classList.add('error');
                error.classList.add('show');
            } else {
                input.classList.remove('error');
                error.classList.remove('show');
            }
        });

        document.getElementById('placementForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const fullname = document.getElementById('fullname').value.trim();
            const ageValue = document.getElementById('age').value.trim();
            const phone = document.getElementById('phone').value;
            const email = document.getElementById('email').value;

            let isValid = true;

            if (fullname.length < 3) {
                document.getElementById('fullname').classList.add('error');
                document.getElementById('fullnameError').classList.add('show');
                isValid = false;
            }

            // Validation de l'âge seulement s'il est renseigné
            if (ageValue !== '') {
                const age = parseInt(ageValue);
                if (isNaN(age) || age < 1 || age > 120) {
                    document.getElementById('age').classList.add('error');
                    document.getElementById('ageError').classList.add('show');
                    isValid = false;
                }
            }

            if (!validatePhone(phone)) {
                document.getElementById('phone').classList.add('error');
                document.getElementById('phoneError').classList.add('show');
                isValid = false;
            }

            if (!validateEmail(email)) {
                document.getElementById('email').classList.add('error');
                document.getElementById('emailError').classList.add('show');
                isValid = false;
            }

            if (!isValid) {
                alert('Vui lòng kiểm tra lại thông tin đã nhập!');
                return;
            }

            const formData = {
                fullname: fullname,
                age: ageValue !== '' ? parseInt(ageValue) : null,
                phone: phone,
                email: email,
                timestamp: new Date().toISOString()
            };

            console.log('Form data:', formData);

            try {
                const response = await fetch('/api/placement-test/register', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(formData)
                });

                if (response.ok) {
                    const result = await response.json();
                    console.log('Server response:', result);
                    
                    document.getElementById('successMessage').classList.add('show');
                    
                    setTimeout(() => {
                        window.location.href = '/test-page.html?id=' + result.testId;
                    }, 2000);
                } else {
                    alert('Có lỗi xảy ra. Vui lòng thử lại!');
                }
            } catch (error) {
                console.error('Error:', error);
                alert('Backend chưa sẵn sàng. Đây là demo giao diện.');
                document.getElementById('successMessage').classList.add('show');
            }
        });
    </script>
</body>
</html>
