<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <title>Test Button Audio</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 50px;
            background: #f5f5f5;
        }
        .container {
            max-width: 600px;
            margin: 0 auto;
            background: white;
            padding: 30px;
            border-radius: 15px;
        }
        .audio-section {
            background: #e3f2fd;
            padding: 20px;
            border-radius: 15px;
            text-align: center;
        }
        .audio-play-btn {
            background: linear-gradient(135deg, #4caf50 0%, #45a049 100%);
            color: white;
            border: none;
            padding: 15px 40px;
            font-size: 18px;
            border-radius: 50px;
            cursor: pointer;
            margin: 15px 0;
            font-weight: bold;
        }
        .audio-play-btn:hover {
            transform: scale(1.05);
        }
        .audio-play-btn.playing {
            background: linear-gradient(135deg, #ff9800 0%, #f57c00 100%);
        }
        #audioProgress {
            width: 100%;
            height: 8px;
            background: #ddd;
            border-radius: 10px;
            overflow: hidden;
            margin: 15px 0;
        }
        #audioProgressBar {
            height: 100%;
            background: linear-gradient(135deg, #4caf50 0%, #45a049 100%);
            width: 0%;
            transition: width 0.1s;
        }
        .log {
            background: #333;
            color: #0f0;
            padding: 15px;
            border-radius: 10px;
            font-family: monospace;
            font-size: 12px;
            max-height: 300px;
            overflow-y: auto;
            margin-top: 20px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üß™ Test Audio Button</h1>
        <p>File n√†y ƒë·ªÉ test xem button c√≥ ho·∫°t ƒë·ªông kh√¥ng</p>
        
        <div class="audio-section">
            <div class="audio-info">‚ö†Ô∏è Click button b√™n d∆∞·ªõi ƒë·ªÉ test</div>
            
            <audio id="mainAudio" style="display: none;">
                <source src="https://axllpuaybdzubfmsfkws.supabase.co/storage/v1/object/public/testsiteaudio_HSK1_2/audio_HSK_1_2.mp3" type="audio/mpeg">
            </audio>
            
            <button id="playBtn" class="audio-play-btn">‚ñ∂Ô∏è Ph√°t Audio</button>
            
            <div id="audioProgress">
                <div id="audioProgressBar"></div>
            </div>
            
            <div id="audioTime">00:00 / 00:00</div>
        </div>
        
        <div class="log" id="logOutput">
            === LOG OUTPUT ===<br>
        </div>
    </div>

    <script>
        const logEl = document.getElementById('logOutput');
        function log(msg) {
            console.log(msg);
            logEl.innerHTML += msg + '<br>';
            logEl.scrollTop = logEl.scrollHeight;
        }
        
        log('=== SCRIPT STARTED ===');
        
        const audio = document.getElementById('mainAudio');
        const playBtn = document.getElementById('playBtn');
        const progressBar = document.getElementById('audioProgressBar');
        const timeDisplay = document.getElementById('audioTime');
        
        log('Audio element: ' + (audio ? 'FOUND ‚úÖ' : 'NOT FOUND ‚ùå'));
        log('Button element: ' + (playBtn ? 'FOUND ‚úÖ' : 'NOT FOUND ‚ùå'));
        log('Audio src: ' + (audio?.currentSrc || 'EMPTY'));
        
        if (!audio || !playBtn) {
            log('‚ùå Elements missing!');
        } else {
            log('‚úÖ All elements OK');
            
            // Load audio
            audio.load();
            log('Audio.load() called');
            
            // Add click event
            playBtn.addEventListener('click', async function() {
                log('=== BUTTON CLICKED ===');
                log('Audio ready state: ' + audio.readyState);
                
                playBtn.textContent = '‚è≥ ƒêang t·∫£i...';
                playBtn.disabled = true;
                
                try {
                    log('Calling audio.play()...');
                    await audio.play();
                    log('‚úÖ Audio.play() SUCCESS!');
                    
                    playBtn.textContent = '‚è∏Ô∏è ƒêang ph√°t...';
                    playBtn.classList.add('playing');
                    
                } catch (error) {
                    log('‚ùå Error: ' + error.message);
                    playBtn.textContent = '‚ùå L·ªói - Th·ª≠ l·∫°i';
                    playBtn.disabled = false;
                    alert('L·ªói: ' + error.message);
                }
            });
            
            log('‚úÖ Event listener added');
            
            // Time update
            audio.addEventListener('timeupdate', function() {
                const progress = (audio.currentTime / audio.duration) * 100;
                progressBar.style.width = progress + '%';
                
                const currentMin = Math.floor(audio.currentTime / 60);
                const currentSec = Math.floor(audio.currentTime % 60);
                const durationMin = Math.floor(audio.duration / 60) || 0;
                const durationSec = Math.floor(audio.duration % 60) || 0;
                
                timeDisplay.textContent = 
                    `${String(currentMin).padStart(2, '0')}:${String(currentSec).padStart(2, '0')} / ` +
                    `${String(durationMin).padStart(2, '0')}:${String(durationSec).padStart(2, '0')}`;
            });
            
            // Ended
            audio.addEventListener('ended', function() {
                log('‚úÖ Audio ENDED');
                playBtn.textContent = '‚ñ∂Ô∏è Ph√°t l·∫°i';
                playBtn.disabled = false;
                playBtn.classList.remove('playing');
                progressBar.style.width = '0%';
            });
            
            // Error
            audio.addEventListener('error', function() {
                log('‚ùå Audio ERROR: ' + (audio.error?.message || 'Unknown'));
            });
            
            // Loaded
            audio.addEventListener('loadedmetadata', function() {
                log('‚úÖ Audio loaded. Duration: ' + audio.duration + 's');
            });
        }
        
        log('=== SCRIPT COMPLETE ===');
        log('');
        log('üìã H√ÄNH ƒê·ªòNG:');
        log('1. Click button "Ph√°t Audio"');
        log('2. Xem log ·ªü ƒë√¢y');
        log('3. N·∫øu kh√¥ng c√≥ log "BUTTON CLICKED" ‚Üí Event listener kh√¥ng add');
        log('4. N·∫øu c√≥ log nh∆∞ng audio kh√¥ng ph√°t ‚Üí URL sai');
    </script>
</body>
</html>
